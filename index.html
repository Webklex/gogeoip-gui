<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="GeoIP Web GUI">
    <meta name="author" content="Webklex">

    <link rel="icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    <title>GoGeoIP Web GUI</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/openlayers/2.13.1/OpenLayers.js"></script>
</head>

<body class="bg-light">
<div class="container-fluid p-md-5">
    <div class="py-5 text-center">
        <h2>GoGeoIP Web Gui Example</h2>
        <p class="lead">
            This is a demo app, made to give an impression on how you might interact with parts of the provided api.
        </p>
    </div>

    <div class="row">
        <div class="col-lg-4 order-sm-1 order-md-1 order-lg-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
                <span>Result</span>
                <span class="badge badge-success badge-pill">14</span>
            </h4>

            <form class="">
                <div class="input-group">
                    <input type="text" class="form-control" id="ip_address-input" placeholder="IP Address or Host">
                    <div class="input-group-append">
                        <button type="button" class="btn btn-outline-primary" id="search-button">Check</button>
                    </div>
                </div>
            </form>

            <div class="my-2">
                <a href="/json?user" target="_blank" class="btn btn-outline-dark">JSON Result</a>
                <a href="/xml?user" target="_blank" class="btn btn-outline-dark">XML Result</a>
                <a href="/csv?user" target="_blank" class="btn btn-outline-dark">CSV Result</a>
            </div>

            <table class="table table-striped col-12">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><h6 class="my-0">IP address</h6></td>
                    <td><small class="text-muted">ip</small></td>
                    <td id="result-ip"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">ASN</h6></td>
                    <td><small class="text-muted">asn.asn</small></td>
                    <td id="result-asn-asn"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">ASO</h6></td>
                    <td><small class="text-muted">asn.aso</small></td>
                    <td id="result-asn-aso"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">In European Union</h6></td>
                    <td><small class="text-muted">is_in_european_union</small></td>
                    <td id="result-is_in_european_union"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Continent Code</h6></td>
                    <td><small class="text-muted">continent_code</small></td>
                    <td id="result-continent_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Country Code</h6></td>
                    <td><small class="text-muted">country_code</small></td>
                    <td id="result-country_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Country Name</h6></td>
                    <td><small class="text-muted">country_name</small></td>
                    <td id="result-country_name"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Region Code</h6></td>
                    <td><small class="text-muted">region_code</small></td>
                    <td id="result-region_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Region Name</h6></td>
                    <td><small class="text-muted">region_name</small></td>
                    <td id="result-region_name"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">City</h6></td>
                    <td><small class="text-muted">city</small></td>
                    <td id="result-city"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Zip Code</h6></td>
                    <td><small class="text-muted">zip_code</small></td>
                    <td id="result-zip_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Time Zone</h6></td>
                    <td><small class="text-muted">time_zone</small></td>
                    <td id="result-time_zone"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Latitude</h6></td>
                    <td><small class="text-muted">latitude</small></td>
                    <td id="result-latitude"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Longitude</h6></td>
                    <td><small class="text-muted">longitude</small></td>
                    <td id="result-longitude"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Accuracy Radius</h6></td>
                    <td><small class="text-muted">accuracy_radius</small></td>
                    <td id="result-accuracy_radius"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Metro Code</h6></td>
                    <td><small class="text-muted">metro_code</small></td>
                    <td id="result-metro_code"></td>
                </tr>

                <tr>
                    <td><h6 class="my-0">Language</h6></td>
                    <td><small class="text-muted">user.language.language</small></td>
                    <td id="result-user-language-language"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Region</h6></td>
                    <td><small class="text-muted">user.language.region</small></td>
                    <td id="result-user-language-region"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Tag</h6></td>
                    <td><small class="text-muted">user.language.tag</small></td>
                    <td id="result-user-language-tag"></td>
                </tr>

                <tr>
                    <td><h6 class="my-0">OS</h6></td>
                    <td><small class="text-muted">user.system.os</small></td>
                    <td id="result-user-system-os"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">OS Version</h6></td>
                    <td><small class="text-muted">user.system.os_version</small></td>
                    <td id="result-user-system-os_version"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Browser</h6></td>
                    <td><small class="text-muted">user.system.browser</small></td>
                    <td id="result-user-system-browser"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Version</h6></td>
                    <td><small class="text-muted">user.system.version</small></td>
                    <td id="result-user-system-version"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Device</h6></td>
                    <td><small class="text-muted">user.system.device</small></td>
                    <td id="result-user-system-device"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Mobile</h6></td>
                    <td><small class="text-muted">user.system.mobile</small></td>
                    <td id="result-user-system-mobile"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Tablet</h6></td>
                    <td><small class="text-muted">user.system.tablet</small></td>
                    <td id="result-user-system-tablet"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Desktop</h6></td>
                    <td><small class="text-muted">user.system.desktop</small></td>
                    <td id="result-user-system-desktop"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Bot</h6></td>
                    <td><small class="text-muted">user.system.bot</small></td>
                    <td id="result-user-system-bot"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Tor</h6></td>
                    <td><small class="text-muted">user.system.tor</small></td>
                    <td id="result-user-system-tor"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="col-lg-8 order-sm-2 order-md-2 order-lg-1">
            <h4 class="mb-3">Map Location</h4>

            <div class="row">
                <div id="map" style="height: 600px; width: 100%;" class="col-lg-12"></div>

                <div class="col-lg-12 pt-2 text-left text-muted">
                    &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank" class="text-muted">OpenStreetMap</a> contributors
                </div>
            </div>
        </div>
    </div>

    <footer class="my-5 pt-5 text-muted text-center text-small">
        <p class="mb-1">
            &copy; 2020 <a href="https://www.webklex.com/" target="_blank" class="text-muted">www.webklex.com</a>
            <br />
            This product includes GeoLite2 data created by MaxMind,
            <br />
            available from <a href="https://www.maxmind.com" class="text-muted">https://www.maxmind.com</a>.
        </p>
    </footer>
</div>
<script
        src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>


<script type="text/javascript">
    (function(){

        function draw_map(longitude, latitude){

            jQuery('#map').html("");

            var map = new OpenLayers.Map("map");
            var mapnik = new OpenLayers.Layer.OSM();

            map.addLayer(mapnik);

            var overlays = new OpenLayers.Layer.Vector("Overlay");
            var markers = new OpenLayers.Layer.Markers( "Markers" );
            map.addLayer(markers);

            var icon_str = "data:image/png;base64,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";

            var size = new OpenLayers.Size(30,30);
            var offset = new OpenLayers.Pixel(-(size.w/2), -size.h);

            var icon = new OpenLayers.Icon(icon_str, size, offset);
            var title = 'sample';

            var lonLat = new OpenLayers.LonLat(longitude, latitude)
                .transform(
                    new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
                    map.getProjectionObject() // to Spherical Mercator Projection
                );

            var description = 'longitude: '+longitude+'<br />latitude: ' + latitude;

            //var marker = new OpenLayers.Marker(lonLat, icon.clone());
            var feature = new OpenLayers.Feature.Vector(
                new OpenLayers.Geometry.Point( longitude, latitude  ).transform(
                    new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
                    map.getProjectionObject() // to Spherical Mercator Projection
                ),
                {description: description} ,
                {externalGraphic: icon_str, graphicHeight: size.w, graphicWidth: size.h, graphicXOffset: -(size.w/2), graphicYOffset:-size.h  }
            );
            overlays.addFeatures(feature);

            map.addLayer(overlays);

            map.setCenter (lonLat, 10);
            //Add a selector control to the vectorLayer with popup functions
            var controls = {
                selector: new OpenLayers.Control.SelectFeature(overlays, { onSelect: createPopup, onUnselect: destroyPopup })
            };

            function createPopup(feature) {
                feature.popup = new OpenLayers.Popup.FramedCloud("pop",
                    feature.geometry.getBounds().getCenterLonLat(),
                    null,
                    '<div class="markerContent" style="white-space: nowrap; overflow-y: hidden !important;">'+feature.attributes.description+'</div>',
                    null,
                    true,
                    function() { controls['selector'].unselectAll(); }
                );
                //feature.popup.closeOnMove = true;
                map.addPopup(feature.popup);
            }

            function destroyPopup(feature) {
                feature.popup.destroy();
                feature.popup = null;
            }

            map.addControl(controls['selector']);
            controls['selector'].activate();


            (function(){
                document.getElementById("OpenLayers_Control_Attribution_7").remove();
            })();
        }

        function renderObject(prefix, obj){
            console.log(prefix)
            jQuery.each(obj, function(key, value) {
                if (typeof value === "object") {
                    renderObject(prefix + "-"+key, value);
                }else{
                    try {
                        let result = jQuery('#'+prefix+'-'+key);
                        result.text(value);
                        if (value !== "" && value !== null && typeof value !== "undefined") {
                            result.addClass("text-success");
                        }else{
                            result.removeClass("text-success");
                        }
                    } catch (e) {}
                }
            });
        }

        function call(ip){
            jQuery.get( "json/"+ip+"?user", function( data ) {
                renderObject("result", data);
                try {
                    draw_map(data.longitude, data.latitude)
                } catch (e) {}
            });
        }

        jQuery('#search-button').bind('click', function () {
            let ip = jQuery('#ip_address-input').val();
            call(ip)
        });

        call("")
    })(jQuery);
</script>
</body>
</html>
