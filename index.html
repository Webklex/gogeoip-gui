<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="GeoIP Web GUI">
    <meta name="author" content="Webklex">

    <link rel="icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    <title>GoGeoIP Web GUI</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/css/ol.css" type="text/css">
    <script src="https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.3.0/build/ol.js"></script>
</head>

<body class="bg-light">
<div class="container-fluid p-md-5">
    <div class="pt-5 text-center">
        <h2>GoGeoIP Web Gui Example</h2>
        <p class="lead">
            This is a demo app, made to give an impression on how you might interact with parts of the provided api.
        </p>
    </div>

    <div class="row">
        <form class="col-xl-8 offset-xl-2 col-md-12 mb-3">
            <div class="row">
                <div class="col-xl-7 col-md-12 mt-2">
                    <div class="input-group">
                        <input type="text" class="form-control" id="ip_address-input" name="ip_address-input" placeholder="IP Address or Host">

                        <div class="input-group-append mr-5">
                            <button type="button" class="btn btn-outline-primary" id="search-button">Check</button>
                        </div>

                    </div>
                </div>
                <div class="col-xl-5 col-md-12 mt-2 text-md-center text-xl-left">
                    <a href="/json?user" target="_blank" class="btn btn-outline-dark">JSON Result</a>
                    <a href="/xml?user" target="_blank" class="btn btn-outline-dark">XML Result</a>
                    <a href="/csv?user" target="_blank" class="btn btn-outline-dark">CSV Result</a>
                </div>
            </div>
        </form>
    </div>
    <div class="row">
        <div class="col-lg-4 order-sm-0 order-md-0 order-lg-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
                <span>Result</span>
                <span class="badge badge-success badge-pill">18</span>
            </h4>

            <table class="table table-striped col-12">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><h6 class="my-0">IP address</h6></td>
                    <td><small class="text-muted">ip</small></td>
                    <td id="result-ip"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">ISP</h6></td>
                    <td><small class="text-muted">isp</small></td>
                    <td id="result-isp"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Domain</h6></td>
                    <td><small class="text-muted">domain</small></td>
                    <td id="result-domain"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">ASN</h6></td>
                    <td><small class="text-muted">asn.asn</small></td>
                    <td id="result-asn-asn"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">ASO</h6></td>
                    <td><small class="text-muted">asn.aso</small></td>
                    <td id="result-asn-aso"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">In European Union</h6></td>
                    <td><small class="text-muted">is_in_european_union</small></td>
                    <td id="result-is_in_european_union"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Continent Code</h6></td>
                    <td><small class="text-muted">continent_code</small></td>
                    <td id="result-continent_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Country Code</h6></td>
                    <td><small class="text-muted">country_code</small></td>
                    <td id="result-country_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Country Name</h6></td>
                    <td><small class="text-muted">country_name</small></td>
                    <td id="result-country_name"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Region Code</h6></td>
                    <td><small class="text-muted">region_code</small></td>
                    <td id="result-region_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Region Name</h6></td>
                    <td><small class="text-muted">region_name</small></td>
                    <td id="result-region_name"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">City</h6></td>
                    <td><small class="text-muted">city</small></td>
                    <td id="result-city"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Zip Code</h6></td>
                    <td><small class="text-muted">zip_code</small></td>
                    <td id="result-zip_code"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Time Zone</h6></td>
                    <td><small class="text-muted">time_zone</small></td>
                    <td id="result-time_zone"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Latitude</h6></td>
                    <td><small class="text-muted">latitude</small></td>
                    <td id="result-latitude"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Longitude</h6></td>
                    <td><small class="text-muted">longitude</small></td>
                    <td id="result-longitude"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Accuracy Radius</h6></td>
                    <td><small class="text-muted">accuracy_radius</small></td>
                    <td id="result-accuracy_radius"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Metro Code</h6></td>
                    <td><small class="text-muted">metro_code</small></td>
                    <td id="result-metro_code"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="col-lg-4 order-sm-1 order-md-1 order-lg-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
                <span>User</span>
                <span class="badge badge-success badge-pill">17</span>
            </h4>

            <table class="table table-striped col-12">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Key</th>
                    <th>Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><h6 class="my-0">Language</h6></td>
                    <td><small class="text-muted">user.language.language</small></td>
                    <td id="result-user-language-language"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Region</h6></td>
                    <td><small class="text-muted">user.language.region</small></td>
                    <td id="result-user-language-region"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Tag</h6></td>
                    <td><small class="text-muted">user.language.tag</small></td>
                    <td id="result-user-language-tag"></td>
                </tr>

                <tr>
                    <td><h6 class="my-0">OS</h6></td>
                    <td><small class="text-muted">user.system.os</small></td>
                    <td id="result-user-system-os"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">OS Version</h6></td>
                    <td><small class="text-muted">user.system.os_version</small></td>
                    <td id="result-user-system-os_version"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Browser</h6></td>
                    <td><small class="text-muted">user.system.browser</small></td>
                    <td id="result-user-system-browser"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Version</h6></td>
                    <td><small class="text-muted">user.system.version</small></td>
                    <td id="result-user-system-version"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Device</h6></td>
                    <td><small class="text-muted">user.system.device</small></td>
                    <td id="result-user-system-device"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Mobile</h6></td>
                    <td><small class="text-muted">user.system.mobile</small></td>
                    <td id="result-user-system-mobile"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Tablet</h6></td>
                    <td><small class="text-muted">user.system.tablet</small></td>
                    <td id="result-user-system-tablet"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Desktop</h6></td>
                    <td><small class="text-muted">user.system.desktop</small></td>
                    <td id="result-user-system-desktop"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Bot</h6></td>
                    <td><small class="text-muted">user.system.bot</small></td>
                    <td id="result-user-system-bot"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Tor</h6></td>
                    <td><small class="text-muted">user.system.tor</small></td>
                    <td id="result-user-system-tor"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Proxy</h6></td>
                    <td><small class="text-muted">user.system.proxy</small></td>
                    <td id="result-user-system-proxy"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Proxy type</h6></td>
                    <td><small class="text-muted">user.system.proxy_type</small></td>
                    <td id="result-user-system-proxy_type"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Last seen</h6></td>
                    <td><small class="text-muted">user.system.last_seen</small></td>
                    <td id="result-user-system-last_seen"></td>
                </tr>
                <tr>
                    <td><h6 class="my-0">Usage type</h6></td>
                    <td><small class="text-muted">user.system.usage_type</small></td>
                    <td id="result-user-system-usage_type"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="col-lg-4 order-sm-2 order-md-2 order-lg-1">
            <h4 class="mb-3">Map Location</h4>
            <div class="row">
                <div id="map" style="height: 600px; width: 100%;" class="col-lg-12"></div>

                <div class="col-lg-12 pt-2 text-left text-muted">
                    &copy; <a href="https://www.openstreetmap.org/copyright" target="_blank" class="text-muted">OpenStreetMap</a> contributors
                </div>
            </div>
        </div>
    </div>

    <footer class="my-5 pt-5 text-muted text-center text-small">
        <p class="mb-1">
            &copy; 2020 <a href="https://www.webklex.com/" target="_blank" class="text-muted">www.webklex.com</a>
            <br />
            This product includes GeoLite2 data created by MaxMind,
            <br />
            available from <a href="https://www.maxmind.com" class="text-muted">https://www.maxmind.com</a>.
            <br />
            This site or product includes IP2Proxy LITE data available from
            <a href="https://lite.ip2location.com" class="text-muted">https://lite.ip2location.com</a>.
        </p>
    </footer>
</div>
<script
        src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>


<script type="text/javascript">
    (function(){

        let attribution = new ol.control.Attribution({
            collapsible: false
        });

        var map = new ol.Map({
            controls: ol.control.defaults({attribution: false}).extend([attribution]),
            layers: [
                new ol.layer.Tile({
                    source: new ol.source.OSM()
                })
            ],
            target: 'map'
        });

        function draw_map(longitude, latitude){

            if (longitude === latitude && latitude === 0) {
                longitude = 4.35247;
                latitude = 50.84673;
            }

            let iconFeature = new ol.Feature({
                geometry: new ol.geom.Point(ol.proj.fromLonLat([longitude, latitude])),
                name: 'Position',
                population: 4000,
                rainfall: 500
            });
            let iconStyle = new ol.style.Style({
                image: new ol.style.Icon(({
                    anchor: [0.5, 0.5],
                    anchorXUnits: 'fraction',
                    anchorYUnits: 'pixels',
                    scale: .2,
                    src: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/88/Map_marker.svg/156px-Map_marker.svg.png'
                }))
            });
            iconFeature.setStyle(iconStyle);

            let layer = new ol.layer.Vector({
                source: new ol.source.Vector({
                    features: [iconFeature]
                })
            });
            map.addLayer(layer);

            map.setView(new ol.View({
                center: ol.proj.fromLonLat([longitude, latitude]),
                //maxZoom: 18,
                zoom: 12
            }));

            map.render();
        }

        function renderObject(prefix, obj){
            jQuery.each(obj, function(key, value) {
                if (typeof value === "object") {
                    renderObject(prefix + "-"+key, value);
                }else{
                    try {
                        let result = jQuery('#'+prefix+'-'+key);
                        result.text(value);
                        if (value !== "" && value !== null && typeof value !== "undefined") {
                            result.addClass("text-success");
                        }else{
                            result.removeClass("text-success");
                        }
                    } catch (e) {}
                }
            });
        }

        function call(ip){
            jQuery.get( "json/"+ip+"?user", function( data ) {
                renderObject("result", data);
                try {
                    draw_map(data.longitude, data.latitude);
                    jQuery('#ip_address-input').val(data.ip)
                } catch (e) {}
            });
        }

        jQuery('#search-button').bind('click', function () {
            let ip = jQuery('#ip_address-input').val();
            call(ip)

        });

        call("")
    })(jQuery);
</script>
</body>
</html>
